# Agency Scheduler Configuration
# Runs scheduled maintenance tasks across repositories

port: 9100

# Director URL for session tracking (sessions will be viewable in web UI)
# Scheduler tries director first, falls back to agent if unavailable.
# Use the web director's internal HTTP port for unauthenticated localhost API.
# Start the web director with: ag-view-web -internal-port=8080
director_url: http://localhost:8080

# Direct agent URL (fallback when director is unavailable)
agent_url: http://localhost:9000

jobs:
  - name: nightly-maintenance
    schedule: "0 1 * * *"
    model: opus
    timeout: 2h
    prompt: |
      # Nightly Maintenance Run

      Perform maintenance tasks across the specified repositories.
      Work through each repository sequentially.

      ## Target Repositories
      - agency
      - opengrok-navigator
      - lldb-objc
      - cue

      ## Tasks for Each Repository

      ### 1. Code Cleanup
      - Remove dead code and unused imports
      - Fix obvious code style issues
      - Remove commented-out code blocks
      - Look for ways to refactor out any duplication
      - Look for any inconsistencies or logic errors

      ### 2. Testing
      - Run the test suite and fix any failing tests
      - Add tests for uncovered edge cases
      - Ensure CI would pass

      ### 3. Bug Fixing
      - Check for and fix any TODO/FIXME items that are straightforward
      - Address any obvious bugs discovered during testing

      ### 4. Documentation Updates
      - Update README if code changes affect usage
      - Ensure doc comments match current behavior
      - Update CHANGELOG with any notable fixes

      ### 5. Report Project Health
      - Summarise the state of the project as you found it
      - Include what you then discovered/did
      - Finish with anything you couldn't do/questions/next steps

      ## Workflow

      For each repository:
      1. Clone from alan-phobos-org/<repo>
      2. Run tests to establish baseline
      3. Perform maintenance tasks
      4. Run tests again to verify no regressions
      5. Commit changes with descriptive messages
      6. Move to next repository
  